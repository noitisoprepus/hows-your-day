@page "/history"
@using HowsYourDayApp.Models
@using HowsYourDayApp.Services
@inject DayService DayService

<PageTitle>History</PageTitle>

<h1>Your Previous Days</h1>

@if (intialized)
{
    @if (days.Count().Equals(0))
    {
        <p>You have not logged yet.</p>
    }
    else
    {
        <ul>
            @foreach (var day in days)
            {
                <li>(@day.LogDate.ToShortDateString()) @day.Rating: @day.Comment</li>
            }
        </ul>
    }
}
else
{
    <div class="spinner-border" role="status" />
}

@code {
    private IEnumerable<DayEntry> days;
    private bool intialized = false;

    protected override async Task OnInitializedAsync()
    {
        await HandleFetchUserDays();
        intialized = true;
    }

    private async Task HandleFetchUserDays()
    {
        days = await DayService.GetDaysForUserAsync();
    }
}
